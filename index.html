<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>InnovateX 2.0 â€” Interview Scoring</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#0b1220; --card:#111a2b; --muted:#93a2b8; --fg:#e6eef6; --accent:#4cc9f0; --ok:#22c55e; --warn:#f59e0b; --err:#ef4444;
    --ring:#264165;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;background:linear-gradient(180deg,#081120,#0b1220 35%,#0f1730);color:var(--fg)}
  .wrap{max-width:900px;margin:28px auto;padding:16px}
  .header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
  .logo{height:60px;width:auto}
  .title-center{font-size:18px;font-weight:700;color:var(--fg);text-align:center}
  .title{font-weight:700;font-size:26px;letter-spacing:.3px;margin:12px 0 6px}
  .sub{color:var(--muted);margin-bottom:18px}
  .badge{display:inline-block;padding:4px 10px;border:1px solid #2a3f6f;border-radius:999px;color:var(--muted);font-size:12px}
  .card{background:var(--card);border:1px solid #1a2540;border-radius:18px;padding:18px 18px 12px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
  .grid{display:grid;gap:14px}
  @media(min-width:720px){.grid{grid-template-columns:1fr 1fr}}
  label{display:block;font-weight:600;margin-bottom:6px}
  input[type=text], input[type=number], select, textarea{
    width:100%;padding:11px 12px;background:#0c1528;border:1px solid #1b2a4a;border-radius:12px;color:var(--fg);outline:none
  }
  input[type=text]:focus, input[type=number]:focus, select:focus, textarea:focus{border-color:var(--accent);box-shadow:0 0 0 4px var(--ring)}
  .row{display:grid;grid-template-columns:1fr 160px;gap:12px;align-items:center;margin-bottom:8px}
  .scorebox{display:flex;gap:8px;align-items:center}
  .hint{color:var(--muted);font-size:12px;margin-left:6px}
  .tot{font-weight:700;font-size:18px}
  .btns{display:flex;gap:10px;flex-wrap:wrap;margin-top:16px}
  button{border:0;border-radius:12px;padding:12px 16px;font-weight:700;cursor:pointer}
  .primary{background:var(--accent);color:#04101e}
  .ghost{background:#17233d;color:var(--fg)}
  .success{color:var(--ok);font-weight:600;margin-top:10px}
  .error{color:var(--err);font-weight:600;margin-top:10px}
  .footer{margin-top:18px;color:var(--muted);font-size:12px;text-align:center}
</style>
</head>
<body>
  <div class="wrap">
    <!-- Header with logos (optional) -->
    <div class="header">
      <img src="images/team-science.png" alt="Team Science" class="logo">
      <div class="title-center">InnovateX 2.0 â€” Interview Scoring</div>
      <img src="images/innovatex.png" alt="InnovateX" class="logo">
    </div>

    <div class="title">InnovateX 2.0 â€” Interview Scoring</div>
    <div class="sub">Fast, fair, and mobile-friendly scoring for all interview panels. <span class="badge">Team Science â€¢ HUS</span></div>

    <div class="card">
      <form id="form" novalidate>
        <div class="grid">
          <div>
            <label for="volunteer">Volunteer Name</label>
            <input id="volunteer" name="volunteer" type="text" placeholder="Enter your name" required>
          </div>
          <div>
            <label for="panelId">Panel ID</label>
            <input id="panelId" name="panelId" type="text" placeholder="e.g., P1 / P2 / Lab-A" required>
          </div>
          <div>
            <label for="studentName">Student Name</label>
            <input id="studentName" name="studentName" type="text" placeholder="Full name" required>
          </div>
          <div>
            <label for="school">School</label>
            <input id="school" name="school" type="text" placeholder="School name" required>
          </div>
          <div>
            <label for="grade">Grade</label>
            <input id="grade" name="grade" type="text" placeholder="e.g., Grade 10 / 11" required>
          </div>
        </div>

        <div style="margin:16px 0 6px;font-weight:700">Scores</div>

        <div class="row">
          <div><label>Interest & Motivation <span class="hint">(0â€“10)</span></label></div>
          <div class="scorebox"><input id="motivation10" name="motivation10" type="number" min="0" max="10" step="1" required></div>
        </div>

        <div class="row">
          <div><label>Basic Knowledge / Curiosity <span class="hint">(0â€“5)</span></label></div>
          <div class="scorebox"><input id="knowledge5" name="knowledge5" type="number" min="0" max="5" step="1" required></div>
        </div>

        <div class="row">
          <div><label>Problem-Solving & Creativity <span class="hint">(0â€“5)</span></label></div>
          <div class="scorebox"><input id="problem5" name="problem5" type="number" min="0" max="5" step="1" required></div>
        </div>

        <div class="row">
          <div><label>Teamwork & Attitude <span class="hint">(0â€“3)</span></label></div>
          <div class="scorebox"><input id="teamwork3" name="teamwork3" type="number" min="0" max="3" step="1" required></div>
        </div>

        <div class="row">
          <div><label>Commitment <span class="hint">(0â€“2)</span></label></div>
          <div class="scorebox"><input id="commitment2" name="commitment2" type="number" min="0" max="2" step="1" required></div>
        </div>

        <div style="display:grid;grid-template-columns:1fr;gap:12px">
          <div class="tot">Total: <span id="total">0</span> / 25</div>
          <label for="remarks">Remarks (optional)</label>
          <textarea id="remarks" name="remarks" rows="3" placeholder="Special talent, attitude, attendance noteâ€¦"></textarea>
        </div>

        <div class="btns">
          <button type="submit" class="primary">Submit Score</button>
          <button type="button" id="clearBtn" class="ghost">Clear</button>
        </div>

        <div id="msg" class="success" style="display:none;">Saved âœ…</div>
        <div id="err" class="error" style="display:none;">Error â€” check connection or try again.</div>
      </form>
    </div>

    <div class="footer">Cutoff suggestion: 15 / 25. Keep interviews 10â€“12 mins. Be kind. Be fair. ðŸ’™</div>
  </div>

<script>
  // === CONFIG: paste your Web App /exec URL here ===
  const API_URL = 'https://script.google.com/macros/s/AKfycbxJkdMUrjvVxRwOjF5TX0azgvKnC4CTkWk9OSePcqQUf8xvA8MGPZWiIcuHzT-wj0Jk/exec';

  const ids = ['motivation10','knowledge5','problem5','teamwork3','commitment2'];
  const totalEl = document.getElementById('total');
  const msgEl = document.getElementById('msg');
  const errEl = document.getElementById('err');

  function computeTotal(){
    let sum = 0;
    ids.forEach(id => {
      const v = parseInt(document.getElementById(id).value || '0', 10);
      sum += isNaN(v) ? 0 : v;
    });
    totalEl.textContent = sum;
    return sum;
  }
  ids.forEach(id => document.getElementById(id).addEventListener('input', computeTotal));

  document.getElementById('clearBtn').addEventListener('click', () => {
    document.getElementById('form').reset();
    computeTotal();
    msgEl.style.display='none';
    errEl.style.display='none';
  });

  document.getElementById('form').addEventListener('submit', async (e) => {
    e.preventDefault();
    msgEl.style.display='none';
    errEl.style.display='none';

    // Validate ranges
    const ranges = { motivation10:[0,10], knowledge5:[0,5], problem5:[0,5], teamwork3:[0,3], commitment2:[0,2] };
    for (const [k,[min,max]] of Object.entries(ranges)) {
      const val = parseInt(document.getElementById(k).value || '0', 10);
      if (isNaN(val) || val < min || val > max) {
        errEl.textContent = `Invalid ${k} â€” must be between ${min} and ${max}.`;
        errEl.style.display = 'block';
        return;
      }
    }

    const payload = {
      volunteer: document.getElementById('volunteer').value.trim(),
      panelId: document.getElementById('panelId').value.trim(),
      studentName: document.getElementById('studentName').value.trim(),
      school: document.getElementById('school').value.trim(),
      grade: document.getElementById('grade').value.trim(),
      motivation10: parseInt(document.getElementById('motivation10').value,10),
      knowledge5: parseInt(document.getElementById('knowledge5').value,10),
      problem5: parseInt(document.getElementById('problem5').value,10),
      teamwork3: parseInt(document.getElementById('teamwork3').value,10),
      commitment2: parseInt(document.getElementById('commitment2').value,10),
      total25: computeTotal(),
      remarks: document.getElementById('remarks').value.trim(),
    };

    try {
  // IMPORTANT: use no-cors and DO NOT set Content-Type header (avoids preflight)
  await fetch(API_URL, {
    method: 'POST',
    mode: 'no-cors',
    body: JSON.stringify(payload)   // Apps Script reads this as e.postData.contents
  });

  // If fetch didn't throw, we optimistically assume success.
  msgEl.style.display = 'block';
  document.getElementById('form').reset();
  computeTotal();
  setTimeout(()=>{ msgEl.style.display='none'; }, 1500);

} catch (e2) {
  errEl.textContent = 'Network error â€” please check internet or try again.';
  errEl.style.display = 'block';
}

  });

  // Prefill panel via URL ?panel=P1
  const params = new URLSearchParams(location.search);
  if (params.get('panel')) document.getElementById('panelId').value = params.get('panel');
  computeTotal();
</script>
</body>
</html>
